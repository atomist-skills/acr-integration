var window=global;var $CLJS=require("./cljs_env");require("./goog.base.js");require("./com.cognitect.transit.util.js");require("./com.cognitect.transit.caching.js");require("./com.cognitect.transit.types.js");
var jw,lw,mw;jw=function(a){this.dc=a};
$CLJS.kw=function(a){this.options=a||{};this.Lb={};for(var b in this.Ue.Lb)this.Lb[b]=this.Ue.Lb[b];for(b in this.options.handlers){a:{switch(b){case "_":case "s":case "?":case "i":case "d":case "b":case "'":case "array":case "map":a=!0;break a}a=!1}if(a)throw Error('Cannot override handler for ground type "'+b+'"');this.Lb[b]=this.options.handlers[b]}this.Kf=null!=this.options.preferStrings?this.options.preferStrings:this.Ue.Kf;this.vg=null!=this.options.preferBuffers?this.options.preferBuffers:
this.Ue.vg;this.lg=this.options.defaultHandler||this.Ue.lg;this.Ic=this.options.mapBuilder;this.ke=this.options.arrayBuilder};
lw=function(a,b,c,d,e){if(e){var f=[];for(e=0;e<b.length;e++)f.push(a.decode(b[e],c,d,!1));return f}f=c&&c.Ua;if(2===b.length&&"string"===typeof b[0]&&(e=a.decode(b[0],c,!1,!1))&&e instanceof jw)return b=b[1],f=a.Lb[e.dc],null!=f?f=f(a.decode(b,c,d,!0),a):$CLJS.Lv(e.dc,a.decode(b,c,d,!1));c&&f!=c.Ua&&(c.Ua=f);if(a.ke){if(32>=b.length&&a.ke.fromArray){f=[];for(e=0;e<b.length;e++)f.push(a.decode(b[e],c,d,!1));return a.ke.fromArray(f,b)}f=a.ke.init(b);for(e=0;e<b.length;e++)f=a.ke.add(f,a.decode(b[e],
c,d,!1),b);return a.ke.finalize(f,b)}f=[];for(e=0;e<b.length;e++)f.push(a.decode(b[e],c,d,!1));return f};mw=function(a,b){if("~"===b.charAt(0)){var c=b.charAt(1);if("~"===c||"^"===c||"`"===c)return b.substring(1);if("#"===c)return new jw(b.substring(2));var d=a.Lb[c];return null==d?a.lg(c,b.substring(2)):d(b.substring(2),a)}return b};
$CLJS.kw.prototype.Ue={Lb:{_:function(){return null},"?":function(a){return"t"===a},b:function(a,b){if(b&&!1===b.vg||"undefined"==typeof $CLJS.ca.Buffer)if("undefined"!=typeof Uint8Array){if("undefined"!=typeof atob)var c=atob(a);else{a=String(a).replace(/=+$/,"");if(1==a.length%4)throw Error("'atob' failed: The string to be decoded is not correctly encoded.");b=0;for(var d,e=0,f="";d=a.charAt(e++);~d&&(c=b%4?64*c+d:d,b++%4)?f+=String.fromCharCode(255&c>>(-2*b&6)):0)d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(d);
c=f}a=c.length;b=new Uint8Array(a);for(d=0;d<a;d++)b[d]=c.charCodeAt(d);c=b}else c=$CLJS.Lv("b",a);else c=new $CLJS.ca.Buffer(a,"base64");return c},i:function(a){"number"===typeof a||a instanceof $CLJS.ha||(a=$CLJS.Jv(a,10),a=0<a.compare($CLJS.hw)||0>a.compare($CLJS.iw)?a:$CLJS.ia(a));return a},n:function(a){return $CLJS.Lv("n",a)},d:function(a){return parseFloat(a)},f:function(a){return $CLJS.Lv("f",a)},c:function(a){return a},":":function(a){return new $CLJS.Mv(a)},$:function(a){return new $CLJS.Nv(a)},
r:function(a){return $CLJS.Lv("r",a)},z:function(a){a:switch(a){case "-INF":a=-Infinity;break a;case "INF":a=Infinity;break a;case "NaN":a=NaN;break a;default:throw Error("Invalid special double value "+a);}return a},"'":function(a){return a},m:function(a){a="number"===typeof a?a:parseInt(a,10);return new Date(a)},t:function(a){return new Date(a)},u:function(a){a=a.replace(/-/g,"");var b,c;var d=b=0;for(c=24;8>d;d+=2,c-=8)b|=parseInt(a.substring(d,d+2),16)<<c;var e=0;d=8;for(c=24;16>d;d+=2,c-=8)e|=
parseInt(a.substring(d,d+2),16)<<c;var f=$CLJS.ja(e,b);b=0;d=16;for(c=24;24>d;d+=2,c-=8)b|=parseInt(a.substring(d,d+2),16)<<c;e=0;for(c=d=24;32>d;d+=2,c-=8)e|=parseInt(a.substring(d,d+2),16)<<c;return new $CLJS.Pv(f,$CLJS.ja(e,b))},set:function(a){return $CLJS.fw(a)},list:function(a){return $CLJS.Lv("list",a)},link:function(a){return $CLJS.Lv("link",a)},cmap:function(a){return $CLJS.cw(a,!1)}},lg:function(a,b){return $CLJS.Lv(a,b)},Kf:!0,vg:!0};
$CLJS.kw.prototype.decode=function(a,b,c,d){if(null==a)return null;switch(typeof a){case "string":return $CLJS.zv(a,c)?(a=mw(this,a),b&&b.write(a,c),b=a):b="^"===a.charAt(0)&&" "!==a.charAt(1)?b.read(a,c):mw(this,a),b;case "object":if((0,$CLJS.yv)(a))if("^ "===a[0])if(this.Ic)if(17>a.length&&this.Ic.fromArray){d=[];for(c=1;c<a.length;c+=2)d.push(this.decode(a[c],b,!0,!1)),d.push(this.decode(a[c+1],b,!1,!1));b=this.Ic.fromArray(d,a)}else{d=this.Ic.init(a);for(c=1;c<a.length;c+=2)d=this.Ic.add(d,this.decode(a[c],
b,!0,!1),this.decode(a[c+1],b,!1,!1),a);b=this.Ic.finalize(d,a)}else{d=[];for(c=1;c<a.length;c+=2)d.push(this.decode(a[c],b,!0,!1)),d.push(this.decode(a[c+1],b,!1,!1));b=$CLJS.cw(d,!1)}else b=lw(this,a,b,c,d);else{c=(0,$CLJS.xv)(a);var e=c[0];if((d=1==c.length?this.decode(e,b,!1,!1):null)&&d instanceof jw)a=a[e],c=this.Lb[d.dc],b=null!=c?c(this.decode(a,b,!1,!0),this):$CLJS.Lv(d.dc,this.decode(a,b,!1,!1));else if(this.Ic)if(16>c.length&&this.Ic.fromArray){var f=[];for(d=0;d<c.length;d++)e=c[d],f.push(this.decode(e,
b,!0,!1)),f.push(this.decode(a[e],b,!1,!1));b=this.Ic.fromArray(f,a)}else{f=this.Ic.init(a);for(d=0;d<c.length;d++)e=c[d],f=this.Ic.add(f,this.decode(e,b,!0,!1),this.decode(a[e],b,!1,!1),a);b=this.Ic.finalize(f,a)}else{f=[];for(d=0;d<c.length;d++)e=c[d],f.push(this.decode(e,b,!0,!1)),f.push(this.decode(a[e],b,!1,!1));b=$CLJS.cw(f,!1)}}return b}return a};$CLJS.kw.prototype.decode=$CLJS.kw.prototype.decode;